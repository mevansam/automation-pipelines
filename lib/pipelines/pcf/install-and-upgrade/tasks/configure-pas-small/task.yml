---
platform: linux

image_resource:
  type: docker-image
  source:
    repository: appbricks/tools

inputs:
- name: automation
- name: pivnet-product
- name: terraform-output

run:
  path: automation/lib/pipelines/pcf/install-and-upgrade/tasks/common/configure-product.sh

params:
  TRACE: Y
  
  OPSMAN_HOST:
  OPSMAN_CLIENT_ID:
  OPSMAN_CLIENT_SECRET:
  OPSMAN_USERNAME:
  OPSMAN_PASSWORD:
  # The IAAS to configure for
  IAAS: 
  # Product configuration
  PRODUCT_NAME: cf
  TEMPLATE_PATH: automation/lib/pipelines/pcf/install-and-upgrade/templates/pas-small
  TEMPLATE_OVERRIDE_PATH:
  ERRANDS_TO_DISABLE:
  ERRANDS_TO_ENABLE:
  ERRAND_DEFAULT_IF_ENABLED: when-changed
  # Networking
  NETWORK_NAME:
  SINGLETON_AVAILABILITY_ZONE:
  AVAILABILITY_ZONES:
  # Resources
  INTERNET_CONNECTED: false
  PAS_HTTP_LB_NAME:
  PAS_TCP_LB_NAME:
  PAS_SSH_LB_NAME:
  PAS_DOPPLER_LB_NAME:
  # Properties
  S3_ACCESS_KEY:
  S3_SECRET_KEY:
  S3_REGION:
  S3_ENDPOINT:
  GCP_STORAGE_ACCESS_KEY:
  GCP_STORAGE_SECRET_KEY:
  TERRAFORM_PREFIX:
  SYSTEM_DOMAIN:
  APPS_DOMAIN:
  ROUTER_STATIC_IPS:
  DIEGO_BRAIN_STATIC_IPS:
  HA_PROXY_STATIC_IPS:
  TCP_ROUTER_STATIC_IPS:
  ERT_CERT:
  ERT_CERT_KEY:
  ROUTING_CUSTOM_CA_CERTIFICATES:
  ROUTING_TLS_TERMINATION:
  ROUTER_TLS_CIPHERS:
  HAPROXY_TLS_CIPHERS:
  HAPROXY_FORWARD_TLS:
  HAPROXY_BACKEND_CA:
  ROUTING_DISABLE_HTTP:
  SKIP_CERT_VERIFY:
  ROUTING_DISABLE_HTTP FALSE:
  CONTAINER_NETWORKING_NETWORK_CIDR:
  CONTAINER_NETWORKING_DNS_SERVERS:
  TCP_ROUTING:
  TCP_ROUTING_RESERVABLE_PORTS:
  ALLOW_APP_SSH_ACCESS:
  DEFAULT_APP_SSH_ACCESS:
  SECURITY_ACKNOWLEDGEMENT:
  INSECURE_DOCKER_REGISTRY_LIST:
  SAML_CERT:
  SAML_CERT_KEY:
  CREDHUB_PRIMARY_ENCRYPTION_NAME:
  CREDHUB_ENCRYPTION_KEY_NAME1:
  CREDHUB_ENCRYPTION_KEY_SECRET1:
  CREDHUB_ENCRYPTION_KEY_NAME2:
  CREDHUB_ENCRYPTION_KEY_SECRET2:
  CREDHUB_ENCRYPTION_KEY_NAME3:
  CREDHUB_ENCRYPTION_KEY_SECRET3:
  DB_TYPE:
  DB_USERNAME:
  DB_PASSWORD:
  MYSQL_PROXY_STATIC_IPS:
  MYSQL_MONITOR_RECIPIENT_EMAIL:
  NOTIFICATIONS_SMTP_FROM:
  NOTIFICATIONS_SMTP_ADDRESS:
  NOTIFICATIONS_SMTP_PORT:
  NOTIFICATIONS_SMTP_TLS_AUTO:
  NUM_DIEGO_CELLS:
  COMPANY_NAME:
